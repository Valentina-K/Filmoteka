{"mappings":"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","sources":["src/js/myLibrary.js"],"sourcesContent":["import storage from './storage';\nimport renderApi from './gallery';\nimport renderModal from './modal';\nconst KEY_QUEUE = 'queue';\nconst KEY_WATCHED = 'watched';\nconst queueArr = storage.load(KEY_QUEUE) ?? [];\nconst watchArr = storage.load(KEY_WATCHED) ?? [];\n\nconst refs = {\n  empty: document.querySelector('.empty'),\n  gallery: document.querySelector('.js-gallery'),\n  galleryItem: document.querySelector('.gallery'),\n  filter: document.querySelector('.filter-thumb'),\n  preloaderElem: document.querySelector('.preloader'),\n  modal: document.querySelector('[data-modal]'),\n  modalElem: document.querySelector('.modal-content'),\n  closeModalBtn: document.querySelector('[data-modal-close]'),\n};\n\nlet movie;\nlet isWatch = true;\nrefs.gallery.style.overflowY = 'auto';\nrefs.closeModalBtn.addEventListener('click', onClose);\nrefs.galleryItem.addEventListener('click', onChooseMovie);\nrefs.modalElem.addEventListener('click', onAddOrRemove);\nconst filterBtns = refs.filter.querySelectorAll('.filter');\nfor (const radio of filterBtns) {\n  radio.addEventListener('change', onChangeFilter);\n}\n\nif (watchArr.length) {\n  //render gallery\n  refs.empty.style.display = 'none';\n  renderApi.clearContent(refs.gallery);\n  refs.preloaderElem.classList.toggle('is-hidden');\n  refs.gallery.classList.remove('is-hidden');\n  renderContent(watchArr);\n  refs.preloaderElem.classList.toggle('is-hidden');\n} else {\n  refs.empty.classList.toggle('is-hidden');\n  refs.gallery.classList.add('is-hidden');\n}\n\nfunction renderContent(content) {\n  const markup = renderApi.creatGalleryItems(content);\n  renderApi.markupContent(markup, refs.gallery);\n}\n\nfunction onChangeFilter(evt) {\n  if (Number(evt.target.value) === 1) {\n    if (watchArr.length) {\n      //render gallery\n      isWatch = true;\n      refs.empty.style.display = 'none';\n      renderApi.clearContent(refs.gallery);\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(watchArr);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    }\n  } else {\n    if (queueArr.length) {\n      //render gallery\n      isWatch = false;\n      refs.empty.style.display = 'none';\n      renderApi.clearContent(refs.gallery);\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(queueArr);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    }\n  }\n}\n\nfunction onClose() {\n  toggleModal();\n  prepareGallery();\n  console.log('isWatch = ', isWatch);\n  if (isWatch) renderContent(watchArr);\n  else renderContent(queueArr);\n}\n\nfunction onChooseMovie(evt) {\n  movie =\n    queueArr.find(item => item.id === Number(evt.target.id)) ??\n    watchArr.find(item => item.id === Number(evt.target.id));\n  renderModal.prepareModalContent(refs.modalElem, movie);\n  renderModal.renderModalBtns(\n    queueArr,\n    watchArr,\n    refs.modalElem,\n    Number(evt.target.id)\n  );\n  toggleModal();\n}\n\nfunction toggleModal() {\n  refs.modal.classList.toggle('is-hidden');\n}\n\nfunction onAddOrRemove(evt) {\n  const btns = evt.target.parentElement;\n  const btn = btns.children;\n  if (evt.target.classList.contains('queue')) {\n    if (evt.target.classList.contains('remove')) {\n      const index = queueArr.indexOf(movie);\n      queueArr.splice(index, 1);\n      storage.save(KEY_QUEUE, queueArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to queue';\n      btn[0].removeAttribute('disabled');\n    } else {\n      queueArr.push(movie);\n      storage.save(KEY_QUEUE, queueArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from queue';\n      btn[0].setAttribute('disabled', 'disabled');\n    }\n  }\n  if (evt.target.classList.contains('watched')) {\n    if (evt.target.classList.contains('remove')) {\n      const index = watchArr.indexOf(movie);\n      watchArr.splice(index, 1);\n      storage.save(KEY_WATCHED, watchArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to watched';\n      btn[1].removeAttribute('disabled');\n    } else {\n      watchArr.push(movie);\n      storage.save(KEY_WATCHED, watchArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from watched';\n      btn[1].setAttribute('disabled', 'disabled');\n    }\n  }\n}\n\nfunction prepareGallery() {\n  renderApi.clearContent(refs.gallery);\n  refs.preloaderElem.classList.toggle('is-hidden');\n}\n"],"names":["$jzQFI","parcelRequire","$220f61a1ea70617b$var$KEY_QUEUE","$220f61a1ea70617b$var$KEY_WATCHED","$220f61a1ea70617b$var$queueArr","default","load","$220f61a1ea70617b$var$watchArr","$220f61a1ea70617b$var$refs","empty","document","querySelector","gallery","galleryItem","filter","preloaderElem","modal","modalElem","closeModalBtn","$220f61a1ea70617b$var$movie","$220f61a1ea70617b$var$isWatch","style","overflowY","addEventListener","$220f61a1ea70617b$var$toggleModal","$8S4BJ","clearContent","classList","toggle","console","log","$220f61a1ea70617b$var$renderContent","evt","find","item","id","Number","target","$5xtVg","prepareModalContent","renderModalBtns","btn","parentElement","children","contains","index","indexOf","splice","save","textContent","removeAttribute","push","setAttribute","$220f61a1ea70617b$var$filterBtns","querySelectorAll","radio","$220f61a1ea70617b$var$onChangeFilter","content","markup","creatGalleryItems","markupContent","value","length","display","remove","add"],"version":3,"file":"my-library.e30c66bf.js.map"}