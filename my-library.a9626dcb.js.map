{"mappings":"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","sources":["src/js/myLibrary.js"],"sourcesContent":["import { auth, onAuthStateChanged, logout } from './auth';\nimport storage from './storage';\nimport renderApi from './gallery';\nimport renderModal from './modal';\n\nconst KEY_QUEUE = 'queue';\nconst KEY_WATCHED = 'watched';\nconst queueArr = storage.load(KEY_QUEUE) ?? [];\nconst watchArr = storage.load(KEY_WATCHED) ?? [];\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    refs.btnLogout.style.display = 'inline-block';\n  } else {\n    refs.btnLogout.style.display = 'none';\n    goUrlJs('./index.html');\n  }\n});\n\nfunction goUrlJs(e) {\n  location.href = e;\n}\nconst refs = {\n  empty: document.querySelector('.empty'),\n  gallery: document.querySelector('.js-gallery'),\n  galleryItem: document.querySelector('.gallery'),\n  filter: document.querySelector('.filter-thumb'),\n  preloaderElem: document.querySelector('.preloader'),\n  modal: document.querySelector('[data-modal]'),\n  modalElem: document.querySelector('.modal-content'),\n  closeModalBtn: document.querySelector('[data-modal-close]'),\n  btnLogout: document.querySelector('.btnLogout'),\n};\n\nlet movie;\nlet isWatch = true;\nrefs.gallery.style.overflowY = 'auto';\nrefs.closeModalBtn.addEventListener('click', onClose);\nrefs.galleryItem.addEventListener('click', onChooseMovie);\nrefs.modalElem.addEventListener('click', onAddOrRemove);\nrefs.btnLogout.addEventListener('click', onLogout);\nwindow.addEventListener('keydown', onEscKeyPress);\nconst filterBtns = refs.filter.querySelectorAll('.filter');\nfor (const radio of filterBtns) {\n  radio.addEventListener('change', onChangeFilter);\n}\n\nif (watchArr.length) {\n  //render gallery\n  refs.empty.style.display = 'none';\n  renderApi.clearContent(refs.gallery);\n  refs.preloaderElem.classList.toggle('is-hidden');\n  refs.gallery.classList.remove('is-hidden');\n  renderContent(watchArr);\n  refs.preloaderElem.classList.toggle('is-hidden');\n} else {\n  refs.empty.classList.toggle('is-hidden');\n  refs.gallery.classList.add('is-hidden');\n}\n\nfunction onLogout() {\n  logout();\n  //refs.btnLogout.style.display = 'none';\n}\n\nfunction onEscKeyPress(even) {\n  if (even.code === 'Escape') {\n    if (!refs.modal.classList.contains('is-hidden')) {\n      toggleModal();\n    }\n  }\n}\n\nfunction renderContent(content) {\n  const markup = renderApi.creatGalleryItems(content);\n  renderApi.markupContent(markup, refs.gallery);\n}\n\nfunction onChangeFilter(evt) {\n  if (Number(evt.target.value) === 1) {\n    if (watchArr.length) {\n      //render gallery\n      isWatch = true;\n      refs.empty.style.display = 'none';\n      renderApi.clearContent(refs.gallery);\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(watchArr);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    }\n  } else {\n    if (queueArr.length) {\n      //render gallery\n      isWatch = false;\n      refs.empty.style.display = 'none';\n      renderApi.clearContent(refs.gallery);\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(queueArr);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    }\n  }\n}\n\nfunction onClose() {\n  toggleModal();\n  renderApi.clearContent(refs.gallery);\n  console.log('isWatch = ', isWatch);\n  if (isWatch) renderContent(watchArr);\n  else renderContent(queueArr);\n}\n\nfunction onChooseMovie(evt) {\n  movie =\n    queueArr.find(item => item.id === Number(evt.target.id)) ??\n    watchArr.find(item => item.id === Number(evt.target.id));\n  renderModal.prepareModalContent(refs.modalElem, movie);\n  renderModal.renderModalBtns(\n    queueArr,\n    watchArr,\n    refs.modalElem,\n    Number(evt.target.id)\n  );\n  toggleModal();\n}\n\nfunction toggleModal() {\n  refs.modal.classList.toggle('is-hidden');\n}\n\nfunction onAddOrRemove(evt) {\n  const btns = evt.target.parentElement;\n  const btn = btns.children;\n  if (evt.target.classList.contains('queue')) {\n    if (evt.target.classList.contains('remove')) {\n      const index = queueArr.indexOf(movie);\n      queueArr.splice(index, 1);\n      storage.save(KEY_QUEUE, queueArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to queue';\n      btn[0].removeAttribute('disabled');\n    } else {\n      queueArr.push(movie);\n      storage.save(KEY_QUEUE, queueArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from queue';\n      btn[0].setAttribute('disabled', 'disabled');\n    }\n  }\n  if (evt.target.classList.contains('watched')) {\n    if (evt.target.classList.contains('remove')) {\n      const index = watchArr.indexOf(movie);\n      watchArr.splice(index, 1);\n      storage.save(KEY_WATCHED, watchArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to watched';\n      btn[1].removeAttribute('disabled');\n    } else {\n      watchArr.push(movie);\n      storage.save(KEY_WATCHED, watchArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from watched';\n      btn[1].setAttribute('disabled', 'disabled');\n    }\n  }\n}\n"],"names":["$euqRf","parcelRequire","$220f61a1ea70617b$var$KEY_QUEUE","$220f61a1ea70617b$var$KEY_WATCHED","$220f61a1ea70617b$var$queueArr","$jzQFI","default","load","$220f61a1ea70617b$var$watchArr","onAuthStateChanged","auth","user","e","$220f61a1ea70617b$var$refs","btnLogout","style","display","location","href","empty","document","querySelector","gallery","galleryItem","filter","preloaderElem","modal","modalElem","closeModalBtn","$220f61a1ea70617b$var$movie","$220f61a1ea70617b$var$isWatch","overflowY","addEventListener","$220f61a1ea70617b$var$toggleModal","$8S4BJ","clearContent","console","log","$220f61a1ea70617b$var$renderContent","evt","find","item","id","Number","target","$5xtVg","prepareModalContent","renderModalBtns","btn","parentElement","children","classList","contains","index","indexOf","splice","save","toggle","textContent","removeAttribute","push","setAttribute","logout","window","even","code","$220f61a1ea70617b$var$filterBtns","querySelectorAll","radio","$220f61a1ea70617b$var$onChangeFilter","content","markup","creatGalleryItems","markupContent","value","length","remove","add"],"version":3,"file":"my-library.a9626dcb.js.map"}