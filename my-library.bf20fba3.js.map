{"mappings":"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","sources":["src/js/myLibrary.js"],"sourcesContent":["import { auth, onAuthStateChanged, logout } from './auth';\nimport renderApi from './gallery';\nimport renderModal from './modal';\nimport { addMovie, getWatchMovies, getQueueMovies, deleteMovie } from './dbApi';\n\nlet queryQ = [];\nlet queryW = [];\n\nconst refs = {\n  empty: document.querySelector('.empty'),\n  gallery: document.querySelector('.js-gallery'),\n  galleryItem: document.querySelector('.gallery'),\n  filter: document.querySelector('.filter-thumb'),\n  preloaderElem: document.querySelector('.preloader'),\n  modal: document.querySelector('[data-modal]'),\n  modalElem: document.querySelector('.modal-content'),\n  closeModalBtn: document.querySelector('[data-modal-close]'),\n  btnLogout: document.querySelector('.btnLogout'),\n  play: document.querySelector('.play'),\n};\n\nlet movie;\nlet isWatch = true;\nrefs.gallery.style.overflowY = 'auto';\nrefs.closeModalBtn.addEventListener('click', onClose);\nrefs.galleryItem.addEventListener('click', onChooseMovie);\nrefs.modalElem.addEventListener('click', onAddOrRemove);\nrefs.btnLogout.addEventListener('click', onLogout);\nrefs.play.addEventListener('click', onPlay);\nwindow.addEventListener('keydown', onEscKeyPress);\nconst filterBtns = refs.filter.querySelectorAll('.filter');\nfor (const radio of filterBtns) {\n  radio.addEventListener('change', onChangeFilter);\n}\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    renderApi.clearContent(refs.gallery);\n    refs.btnLogout.style.display = 'inline-block';\n    getQueueMovies(user.uid).then(data => (queryQ = data));\n    getWatchMovies(user.uid).then(data => {\n      if (data.length) {\n        //render gallery\n        refs.empty.style.display = 'none';\n        refs.preloaderElem.classList.toggle('is-hidden');\n        refs.gallery.classList.remove('is-hidden');\n        renderContent(data);\n        refs.preloaderElem.classList.toggle('is-hidden');\n      } else {\n        refs.empty.style.display = 'block';\n        refs.gallery.classList.add('is-hidden');\n      }\n      queryW = data;\n    });\n  } else {\n    refs.btnLogout.style.display = 'none';\n    location.href = './index.html';\n  }\n});\n\nfunction onLogout() {\n  logout();\n}\n\nfunction onEscKeyPress(even) {\n  if (even.code === 'Escape') {\n    if (!refs.modal.classList.contains('is-hidden')) {\n      toggleModal();\n    }\n  }\n}\n\nfunction onPlay() {\n  const player = new Plyr('#player', {});\n  // Expose player so it can be used from the console\n  refs.play.style.display = 'none';\n  renderModal.prepareModalPreview(refs.modalElem, movie.youtubeId);\n  window.player = player;\n}\n\nfunction renderContent(content) {\n  const markup = renderApi.creatGalleryItems(content);\n  renderApi.markupContent(markup, refs.gallery);\n}\n\nfunction onChangeFilter(evt) {\n  renderApi.clearContent(refs.gallery);\n  if (Number(evt.target.value) === 1) {\n    if (queryW.length) {\n      //render gallery\n      isWatch = true;\n      refs.empty.style.display = 'none';\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(queryW);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    } else {\n      refs.empty.style.display = 'block';\n      refs.gallery.classList.add('is-hidden');\n    }\n  } else {\n    if (queryQ.length) {\n      //render gallery\n      isWatch = false;\n      refs.empty.style.display = 'none';\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(queryQ);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    } else {\n      refs.empty.style.display = 'block';\n      refs.gallery.classList.add('is-hidden');\n    }\n  }\n}\n\nfunction onClose() {\n  toggleModal();\n  renderApi.clearContent(refs.gallery);\n  if (isWatch) renderContent(queryW);\n  else renderContent(queryQ);\n}\n\nfunction onChooseMovie(evt) {\n  movie =\n    queryQ.find(item => item.id === Number(evt.target.id)) ??\n    queryW.find(item => item.id === Number(evt.target.id));\n  if (movie.youtubeId !== undefined) {\n    refs.play.style.display = 'block';\n  } else {\n    refs.play.style.display = 'none';\n  }\n  renderModal.prepareModalContent(refs.modalElem, movie);\n  renderModal.renderModalBtns(\n    queryQ,\n    queryW,\n    refs.modalElem,\n    Number(evt.target.id)\n  );\n  toggleModal();\n}\n\nfunction toggleModal() {\n  refs.modal.classList.toggle('is-hidden');\n}\n\nfunction onAddOrRemove(evt) {\n  const btns = evt.target.parentElement;\n  const btn = btns.children;\n  if (evt.target.classList.contains('queue')) {\n    if (evt.target.classList.contains('remove')) {\n      deleteMovie(movie.id);\n      const index = queryQ.indexOf(movie);\n      queryQ.splice(index, 1);\n      //storage.save(KEY_QUEUE, queryQ); here is removeMovies\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to queue';\n      btn[0].removeAttribute('disabled');\n    } else {\n      movie.isQueue = true;\n      movie.isWatch = false;\n      queryQ.push(movie);\n      //storage.save(KEY_QUEUE, queryQ); here is removeMovies\n      addMovie(movie);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from queue';\n      btn[0].setAttribute('disabled', 'disabled');\n    }\n    renderContent(queryQ);\n  }\n  if (evt.target.classList.contains('watched')) {\n    if (evt.target.classList.contains('remove')) {\n      deleteMovie(movie.id);\n      const index = queryW.indexOf(movie);\n      queryW.splice(index, 1);\n      //storage.save(KEY_WATCHED, queryW); here is removeMovies\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to watched';\n      btn[1].removeAttribute('disabled');\n    } else {\n      movie.isWatch = true;\n      movie.isQueue = false;\n      queryW.push(movie);\n      //storage.save(KEY_WATCHED, queryW); here is removeMovies\n      addMovie(movie);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from watched';\n      btn[1].setAttribute('disabled', 'disabled');\n    }\n    renderContent(queryW);\n  }\n}\n"],"names":["$euqRf","parcelRequire","$220f61a1ea70617b$var$queryQ","$220f61a1ea70617b$var$queryW","$220f61a1ea70617b$var$refs","empty","document","querySelector","gallery","galleryItem","filter","preloaderElem","modal","modalElem","closeModalBtn","btnLogout","play","$220f61a1ea70617b$var$movie","$220f61a1ea70617b$var$isWatch","style","overflowY","addEventListener","$220f61a1ea70617b$var$toggleModal","$8S4BJ","default","clearContent","$220f61a1ea70617b$var$renderContent","evt","find","item","id","Number","target","undefined","youtubeId","display","$5xtVg","prepareModalContent","renderModalBtns","btn","parentElement","children","classList","contains","$imkDK","deleteMovie","index","indexOf","splice","toggle","textContent","removeAttribute","isQueue","isWatch","push","addMovie","setAttribute","logout","player","Plyr","prepareModalPreview","window","even","code","$220f61a1ea70617b$var$filterBtns","querySelectorAll","radio","$220f61a1ea70617b$var$onChangeFilter","content","markup","creatGalleryItems","markupContent","value","length","remove","add","onAuthStateChanged","auth","user","getQueueMovies","uid","then","data","getWatchMovies","location","href"],"version":3,"file":"my-library.bf20fba3.js.map"}