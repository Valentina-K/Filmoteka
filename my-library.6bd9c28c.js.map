{"mappings":"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","sources":["src/js/myLibrary.js"],"sourcesContent":["import storage from './storage';\nimport renderApi from './gallery';\nimport renderModal from './modal';\nconst KEY_QUEUE = 'queue';\nconst KEY_WATCHED = 'watched';\nconst queueArr = storage.load(KEY_QUEUE) ?? [];\nconst watchArr = storage.load(KEY_WATCHED) ?? [];\n\nconst refs = {\n  empty: document.querySelector('.empty'),\n  gallery: document.querySelector('.js-gallery'),\n  galleryItem: document.querySelector('.gallery'),\n  filter: document.querySelector('.filter-thumb'),\n  preloaderElem: document.querySelector('.preloader'),\n  modal: document.querySelector('[data-modal]'),\n  modalElem: document.querySelector('.modal-content'),\n  closeModalBtn: document.querySelector('[data-modal-close]'),\n};\n\nlet movie;\nlet isWatch = true;\nrefs.gallery.style.overflowY = 'auto';\nrefs.closeModalBtn.addEventListener('click', onClose);\nrefs.galleryItem.addEventListener('click', onChooseMovie);\nrefs.modalElem.addEventListener('click', onAddOrRemove);\nwindow.addEventListener('keydown', onEscKeyPress);\nconst filterBtns = refs.filter.querySelectorAll('.filter');\nfor (const radio of filterBtns) {\n  radio.addEventListener('change', onChangeFilter);\n}\n\nif (watchArr.length) {\n  //render gallery\n  refs.empty.style.display = 'none';\n  renderApi.clearContent(refs.gallery);\n  refs.preloaderElem.classList.toggle('is-hidden');\n  refs.gallery.classList.remove('is-hidden');\n  renderContent(watchArr);\n  refs.preloaderElem.classList.toggle('is-hidden');\n} else {\n  refs.empty.classList.toggle('is-hidden');\n  refs.gallery.classList.add('is-hidden');\n}\n\nfunction onEscKeyPress(even) {\n  if (even.code === 'Escape') {\n    if (!refs.modal.classList.contains('is-hidden')) {\n      toggleModal();\n    }\n  }\n}\n\nfunction renderContent(content) {\n  const markup = renderApi.creatGalleryItems(content);\n  renderApi.markupContent(markup, refs.gallery);\n}\n\nfunction onChangeFilter(evt) {\n  if (Number(evt.target.value) === 1) {\n    if (watchArr.length) {\n      //render gallery\n      isWatch = true;\n      refs.empty.style.display = 'none';\n      renderApi.clearContent(refs.gallery);\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(watchArr);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    }\n  } else {\n    if (queueArr.length) {\n      //render gallery\n      isWatch = false;\n      refs.empty.style.display = 'none';\n      renderApi.clearContent(refs.gallery);\n      refs.preloaderElem.classList.toggle('is-hidden');\n      refs.gallery.classList.remove('is-hidden');\n      renderContent(queueArr);\n      refs.preloaderElem.classList.toggle('is-hidden');\n    }\n  }\n}\n\nfunction onClose() {\n  toggleModal();\n  renderApi.clearContent(refs.gallery);\n  console.log('isWatch = ', isWatch);\n  if (isWatch) renderContent(watchArr);\n  else renderContent(queueArr);\n}\n\nfunction onChooseMovie(evt) {\n  movie =\n    queueArr.find(item => item.id === Number(evt.target.id)) ??\n    watchArr.find(item => item.id === Number(evt.target.id));\n  renderModal.prepareModalContent(refs.modalElem, movie);\n  renderModal.renderModalBtns(\n    queueArr,\n    watchArr,\n    refs.modalElem,\n    Number(evt.target.id)\n  );\n  toggleModal();\n}\n\nfunction toggleModal() {\n  refs.modal.classList.toggle('is-hidden');\n}\n\nfunction onAddOrRemove(evt) {\n  const btns = evt.target.parentElement;\n  const btn = btns.children;\n  if (evt.target.classList.contains('queue')) {\n    if (evt.target.classList.contains('remove')) {\n      const index = queueArr.indexOf(movie);\n      queueArr.splice(index, 1);\n      storage.save(KEY_QUEUE, queueArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to queue';\n      btn[0].removeAttribute('disabled');\n    } else {\n      queueArr.push(movie);\n      storage.save(KEY_QUEUE, queueArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from queue';\n      btn[0].setAttribute('disabled', 'disabled');\n    }\n  }\n  if (evt.target.classList.contains('watched')) {\n    if (evt.target.classList.contains('remove')) {\n      const index = watchArr.indexOf(movie);\n      watchArr.splice(index, 1);\n      storage.save(KEY_WATCHED, watchArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Add to watched';\n      btn[1].removeAttribute('disabled');\n    } else {\n      watchArr.push(movie);\n      storage.save(KEY_WATCHED, watchArr);\n      evt.target.classList.toggle('remove');\n      evt.target.textContent = 'Remove from watched';\n      btn[1].setAttribute('disabled', 'disabled');\n    }\n  }\n}\n"],"names":["$5uEKZ","parcelRequire","$4579d646e857668e$var$queueArr","default","load","$4579d646e857668e$var$watchArr","$4579d646e857668e$var$refs","empty","document","querySelector","gallery","galleryItem","filter","preloaderElem","modal","modalElem","closeModalBtn","$4579d646e857668e$var$movie","$4579d646e857668e$var$isWatch","style","overflowY","addEventListener","$4579d646e857668e$var$toggleModal","$aFV0K","clearContent","console","log","$4579d646e857668e$var$renderContent","evt","find","item","id","Number","target","$bTcpz","prepareModalContent","renderModalBtns","btn","parentElement","children","classList","contains","index","indexOf","splice","save","toggle","textContent","removeAttribute","push","setAttribute","window","even","code","$4579d646e857668e$var$filterBtns","querySelectorAll","radio","$4579d646e857668e$var$onChangeFilter","content","markup","creatGalleryItems","markupContent","value","length","display","remove","add"],"version":3,"file":"my-library.6bd9c28c.js.map"}